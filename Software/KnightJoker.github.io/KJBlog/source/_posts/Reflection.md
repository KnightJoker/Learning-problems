title: 反射机制
date: 2016/05/19 16:46:25
description: Objective - C 也提供了类似于Java的反射机制，这种动态编程机制可以让Objective - C变得更加灵活起来。这里也提供了三种编程方式与运行环境进行交互
categories:
- iOS
tags:
- 面向对象

---
关于反射机制的使用，举个例子来说：

```
假如有一天你有这么一个需求：根据后台推送过来的数据，进行动态页面跳转，跳转到页面后根据返回到数据执行对应的操作。
```

遇见这要的要求，这里肯定的解决方案就有三种（咳咳咳，其实是自己只想到三种，如果有其他方法，欢迎大家进行补充~）

1. 根据情况，然后写一大堆的`if else`或者`switch`来进行判断。此方法不进行推荐，如果条件变化，程序鲁棒性较差。

2. 通过`runtime`实现

3. 这时候便可以使用反射机制了，这里便可以利用反射机制动态的创建类并执行方法。这时候就需要和后台配合了，我们首先需要和后台商量好返回的数据结构，以及数据格式、类型等，返回后我们按照和后台约定的格式，根据后台返回的信息，直接进行反射和调用即可。

当然Objective - C 也提供了类似于Java的反射机制，这种动态编程机制可以让Objective - C变得更加灵活起来。这里也提供了三种编程方式与运行环境进行交互：

- 直接通过Objective - C 的源代码，这是最为常见的方式。开发人员只是编写源代码，而运行环境负责在后台工作。当我们在进行源代码编译的时候，编译器就会创建大量数据结构和实现了动态机制的函数。其中数据结构负责保存类、类别（category）中定义的数据，而函数则负责处理方法调用。

- 通过NSObject 类中定义的方法进行动态编程。因为绝大多数的类都是NSObject子类，所以大部分对象都继承了NSObject的方法，故所有的对象都可以直接调用NSObject的方法来编程。 这里的NSObject可以提供`isKindOfClass: 、 isMemberOfClass:`这两个方法可以用于判断该类所属的类。`respondsToSelector:`可以用于判断该实例是否可调用指定方法；`conformsToProtocol:`可用于判断该对象是否遵守指定协议；`methodForSelector`则用于返回指定方法实现的指针。

- 直接调用运行时函数进行动态编程。运行时系统是一个动态共享库，由系统位于`/usr/include/objc`目录的头文件中的函数和数据结构组成，这些工具都是C风格的，它们并不是 Objective - C 编程必需的，但有些函数有时候也是有用的。在这里可以参考Xcode帮助系统的 Objective - C Runtime Reference 帮助手册。

